
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tuning VAST DB for Trino &#8212; Data Platform Field Docs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'vast_database/tuning/trino/howto';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="../../nifi/overview.html" />
    <link rel="prev" title="Tuning" href="../python/howto.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Data Platform Field Docs - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Data Platform Field Docs - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Data Platform Field Docs
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Datastore</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../vast_datastore/overview.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../vast_datastore/vastpy/overview.html">Python Library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../vast_datastore/vastpy/enablecatalog.html">Enable Catalog</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Database</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../overview/getting_started.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ingestion/ingestion.html">Data Ingestion</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ingestion/python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ingestion/nifi.html">Apache NiFi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ingestion/spark.html">Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ingestion/python_kafka.html">Kafka via Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ingestion/spark_streaming_python_sdk.html">Kafka via Spark Streaming</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../query/query.html">Data Querying</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../query/dremio_quickstart/howto.html">Dremio Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../query/trino_quickstart/howto.html">Trino Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../query/python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../query/spark.html">Spark</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sdk_ref/intro.html">Python SDK Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sdk_ref/create_session.html">Creating a session</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sdk_ref/importing_files.html">Importing Files, API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sdk_ref/importing_files_pandas.html">Importing Files, Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sdk_ref/projections.html">Projections</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../spark/overview.html">Spark Operations Guide</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../tuning.html">Performance Tuning</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../python/howto.html">Tuning Python SDK</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tuning Trino</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../nifi/overview.html">Apache NiFi Patterns</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../nifi/quickstart.html">Apache NiFi Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nifi/bulk_import.html">Bulk Import from S3</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../misc/overview.html">Extras</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/vastdb_py_setup.html">VastDB setup using API</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Catalog</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../vast_catalog/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vast_catalog/python-sdk-vast-catalog.html">Python SDK Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Vast Data Engine</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../vast_dataengine/overview.html">Overview</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Site Info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../feedback/intro.html">Feedback</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vast-data/data-platform-field-docs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vast-data/data-platform-field-docs/issues/new?title=Issue%20on%20page%20%2Fvast_database/tuning/trino/howto.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/vast_database/tuning/trino/howto.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tuning VAST DB for Trino</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#guidance-instructions-for-parallelization-using-splits-and-sub-splits">Guidance Instructions for Parallelization Using Splits and Sub splits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concept-of-splits-summary">Concept of Splits Summary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-considerations">Optimization Considerations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-statistics-to-improve-trino-and-its-cost-based-optimizer-cbo">Tables Statistics to Improve TRINO and its Cost based optimizer (CBO)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-options">Common Options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sizing-worker-nodes-for-vast-workloads">Sizing worker nodes for Vast workloads</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-practice-on-connecting-bi-tools">Best Practice on Connecting BI Tools</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tuning-vast-db-for-trino">
<h1>Tuning VAST DB for Trino<a class="headerlink" href="#tuning-vast-db-for-trino" title="Link to this heading">#</a></h1>
<p>Example config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vast</span><span class="p">:</span> <span class="o">|-</span>
  <span class="n">connector</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">vast</span>
  <span class="n">endpoint</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.12.200.41</span>
  <span class="n">region</span><span class="o">=</span><span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mi">1</span>
  <span class="n">access_key_id</span><span class="o">=</span><span class="p">{</span><span class="n">access</span><span class="p">}</span>
  <span class="n">secret_access_key</span><span class="o">=</span><span class="p">{[</span><span class="n">Vast</span> <span class="n">Secret</span> <span class="n">Key</span><span class="p">]}</span>
  <span class="n">num_of_splits</span><span class="o">=</span><span class="mi">64</span>
  <span class="n">num_of_subsplits</span><span class="o">=</span><span class="mi">10</span>
  <span class="n">vast</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">request</span><span class="o">-</span><span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="n">m</span>
  <span class="n">vast</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">idle</span><span class="o">-</span><span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="n">m</span>
  <span class="n">data_endpoints</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.12.200.41</span><span class="p">,</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.12.200.33</span>
</pre></div>
</div>
<section id="guidance-instructions-for-parallelization-using-splits-and-sub-splits">
<h2>Guidance Instructions for Parallelization Using Splits and Sub splits<a class="headerlink" href="#guidance-instructions-for-parallelization-using-splits-and-sub-splits" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">num_of_splits=64</span></code></p>
<p>Parallelizing scans across the row ID space of the Vast table is achieved in two main levels. The first level is based on <strong>splits</strong>, which the <strong>Trino query</strong> engine understands and manages.</p>
<ul class="simple">
<li><p><strong>How splits work</strong>:</p>
<ul>
<li><p>When a query is executed, the Trino coordinator communicates with the Vast connector to determine the number of splits to be used for the table. In this case, the recommended number of splits is 64.</p></li>
<li><p>For optimal efficiency, each split should process at least <strong>4 million rows</strong>. If the table contains, for instance, <strong>256 million rows</strong> or more, the system will utilize all 64 splits. Each split handles a distinct portion of the table, dividing it into 64 segments, allowing Trino to scan the table in parallel.</p></li>
</ul>
</li>
<li><p><strong>Parallelization across Trino tasks and RPCs</strong>: Trino distributes these splits across its threads (known as tasks), and each split is sent as a set of Remote Procedure Calls (RPCs) that continuously scan that specific split of the table. This process enables parallel scanning of the data.</p></li>
<li><p><strong>Distribution across data endpoints</strong>: The splits are evenly distributed across data endpoints in a round-robin manner. This ensures that each data endpoint processes a unique split, allowing for efficient use of all available endpoints.</p></li>
<li><p><strong>Utilization of compute nodes</strong>: We recommend evenly distributing the data endpoints across the partitions of the compute nodes. This ensures that the full capacity of all compute nodes is utilized concurrently to handle the scan.</p></li>
</ul>
<section id="concept-of-splits-summary">
<h3>Concept of Splits Summary<a class="headerlink" href="#concept-of-splits-summary" title="Link to this heading">#</a></h3>
<p>Splits divide the table for parallel processing, distributing the workload across Trino workers and compute nodes to maximize performance and efficiency.</p>
<p><code class="docutils literal notranslate"><span class="pre">num_of_subsplits=10</span></code></p>
<p>The second level of parallelism occurs within each split through the concept of subsplits.</p>
<ul class="simple">
<li><p><strong>How subsplits work</strong>:</p>
<ul>
<li><p>Once a split reaches a specific data endpoint, it can be further divided into subsplits. Since each compute node (C node) has multiple cores, subsplits allow for more granular division of the work. In this case, each split is broken into 10 subsplits.</p></li>
<li><p>Each subsplit represents a shard of the row ID space and is distributed to different cores within the compute nodes, allowing for parallel processing within the node.</p></li>
</ul>
</li>
<li><p><strong>Core utilization within compute nodes</strong>: The subsplits ensure that all the cores within a compute node are efficiently utilized to process the split. Essentially, this provides two levels of parallelism:</p>
<ul>
<li><p>Across data endpoints, controlled by the number of splits.</p></li>
<li><p>Within each data endpoint (or C node), controlled by the number of subsplits.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="optimization-considerations">
<h2>Optimization Considerations<a class="headerlink" href="#optimization-considerations" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Splits and Trino workers</strong>: To optimize performance, the number of splits should ideally be divisible by the number of Trino workers. This ensures that the workload is evenly distributed across all available workers, maximizing efficiency.</p></li>
<li><p><strong>Subsplits and cores</strong>: Similarly, the number of subsplits should be divisible by the number of cores available in each compute node. This allows for even workload distribution across all cores within the node.</p></li>
<li><p>The system uses a heuristic based on estimated statistics from Vast to determine the row count for each Table.</p></li>
<li><p>If statistics are available, the number of splits (64 in this case) is used as an upper limit. However, if the table is smaller, the system automatically reduces the number of splits accordingly, ensuring it doesn’t exceed the upper limit of 64 splits.</p></li>
<li><p>You want to aim for four million records per Split . If you try to go smaller you will get performance degradation in attempting to split that workload up</p></li>
</ul>
</section>
<section id="tables-statistics-to-improve-trino-and-its-cost-based-optimizer-cbo">
<h2>Tables Statistics to Improve TRINO and its Cost based optimizer (CBO)<a class="headerlink" href="#tables-statistics-to-improve-trino-and-its-cost-based-optimizer-cbo" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Run the Analyzer on the Tables:
o	If you haven’t run the analyzer on the tables yet, it’s recommended to do so. This helps optimize query performance.</p></li>
<li><p>Purpose:
o	Running the analyzer can assist the Trino cost-based optimizer in selecting more efficient query execution plans, especially for joins.</p></li>
<li><p>Outcome:
o	By analyzing the tables, you can potentially improve query performance by allowing the system to choose better optimization strategies for complex operations like joins.</p></li>
</ol>
</section>
<section id="common-options">
<h2>Common Options<a class="headerlink" href="#common-options" title="Link to this heading">#</a></h2>
<p><img alt="Common Options" src="../../../_images/common_options.png" /></p>
<p>A common strategy for larger tables is to use a join that distributes the data efficiently across multiple nodes. However, for smaller tables, a broadcast join can be used, where all the data is grouped into a single node for processing.</p>
<p><code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">SESSION</span> <span class="pre">join_distribution_type</span> <span class="pre">=</span> <span class="pre">'BROADCAST';</span></code></p>
<p>These parameters control memory usage at the query level:</p>
<ul class="simple">
<li><p><strong>query.max-memory</strong>: Description: Sets the maximum amount of distributed memory that a single query can use across all nodes. This is critical for preventing a single query from consuming too much memory and impacting other queries.</p></li>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">query.max-memory=30GB</span></code></p></li>
<li><p><strong>query.max-memory-per-node</strong>: Description: Sets the maximum amount of memory that a single query can use on any single node. This helps in preventing one node from being overloaded by a specific query.</p></li>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">query.max-memory-per-node=5GB</span></code></p></li>
<li><p><strong>query.max-total-memory-per-node</strong>: Description: Sets the maximum total memory (user memory + system memory) a single query can use per node. This includes both the memory used by the query itself and by the system to process the query.</p></li>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">query.max-total-memory-per-node=10GB</span></code></p></li>
</ul>
</section>
<section id="sizing-worker-nodes-for-vast-workloads">
<h2>Sizing worker nodes for Vast workloads<a class="headerlink" href="#sizing-worker-nodes-for-vast-workloads" title="Link to this heading">#</a></h2>
<p>When sizing worker nodes for Vast workloads, a general recommendation is to use fewer, larger nodes rather than many smaller nodes. This reduces data shuffling and improves performance. However, the optimal configuration depends on memory availability and the size of the tables being joined in memory.</p>
<p>For large data processing, more memory is required for joins. Trino can either perform joins in memory or use a “fail-safe” mode, where intermediate results are written to storage to avoid crashes, though this takes longer. The amount of memory needed depends on the size of the tables and the filtering applied by Vast before data is processed by Trino.</p>
<p>Filtering happens in Vast, and only relevant rows are passed to Trino. Trino’s cost-based optimizer uses statistics to estimate the number of rows and determines the best join strategy. Analyzing tables helps improve memory usage estimation and optimization.</p>
<p>Additionally, using broadcast joins can reduce latency by minimizing data shuffling, particularly for join-heavy queries. Adjusting the max memory of worker nodes is important as memory is increased.</p>
</section>
<section id="best-practice-on-connecting-bi-tools">
<h2>Best Practice on Connecting BI Tools<a class="headerlink" href="#best-practice-on-connecting-bi-tools" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Superset → requires different vastdb schema separator</p></li>
<li><p>Thoughtspot → required Information Schema for VAST DB, build into new connector list the fixed version.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./vast_database/tuning/trino"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../python/howto.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tuning</p>
      </div>
    </a>
    <a class="right-next"
       href="../../nifi/overview.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Overview</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#guidance-instructions-for-parallelization-using-splits-and-sub-splits">Guidance Instructions for Parallelization Using Splits and Sub splits</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concept-of-splits-summary">Concept of Splits Summary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-considerations">Optimization Considerations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-statistics-to-improve-trino-and-its-cost-based-optimizer-cbo">Tables Statistics to Improve TRINO and its Cost based optimizer (CBO)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-options">Common Options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sizing-worker-nodes-for-vast-workloads">Sizing worker nodes for Vast workloads</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-practice-on-connecting-bi-tools">Best Practice on Connecting BI Tools</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By VAST Data
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
  <a href="https://vast-data.github.io/data-platform-field-docs/feedback/intro.html">Provide Feedback</a>
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>